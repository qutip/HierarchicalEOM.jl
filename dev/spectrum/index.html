<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Spectrum · Documentation | HierarchicalEOM.jl</title><meta name="title" content="Spectrum · Documentation | HierarchicalEOM.jl"/><meta property="og:title" content="Spectrum · Documentation | HierarchicalEOM.jl"/><meta property="twitter:title" content="Spectrum · Documentation | HierarchicalEOM.jl"/><meta name="description" content="Documentation for Documentation | HierarchicalEOM.jl."/><meta property="og:description" content="Documentation for Documentation | HierarchicalEOM.jl."/><meta property="twitter:description" content="Documentation for Documentation | HierarchicalEOM.jl."/><meta property="og:url" content="https://qutip.github.io/HierarchicalEOM.jl/spectrum/"/><meta property="twitter:url" content="https://qutip.github.io/HierarchicalEOM.jl/spectrum/"/><link rel="canonical" href="https://qutip.github.io/HierarchicalEOM.jl/spectrum/"/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img class="docs-light-only" src="../assets/logo.png" alt="Documentation | HierarchicalEOM.jl logo"/><img class="docs-dark-only" src="../assets/logo-dark.png" alt="Documentation | HierarchicalEOM.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">Documentation | HierarchicalEOM.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><span class="tocitem">Home</span><ul><li><a class="tocitem" href="../">Introduction</a></li><li><a class="tocitem" href="../install/">Installation</a></li><li><a class="tocitem" href="../quick_start/">Quick Start</a></li><li><a class="tocitem" href="../cite/">Cite HierarchicalEOM.jl</a></li></ul></li><li><span class="tocitem">Manual</span><ul><li><input class="collapse-toggle" id="menuitem-2-1" type="checkbox"/><label class="tocitem" for="menuitem-2-1"><span class="docs-label">Bosonic Bath</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../bath_boson/bosonic_bath_intro/">Introduction</a></li><li><a class="tocitem" href="../bath_boson/Boson_Drude_Lorentz/">Drude-Lorentz Spectral Density</a></li><li><a class="tocitem" href="../bath_boson/Boson_Underdamped/">Underdamped Spectral Density</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-2-2" type="checkbox"/><label class="tocitem" for="menuitem-2-2"><span class="docs-label">Bosonic Bath (RWA)</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../bath_boson_RWA/bosonic_bath_RWA_intro/">Introduction</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-2-3" type="checkbox"/><label class="tocitem" for="menuitem-2-3"><span class="docs-label">Fermionic Bath</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../bath_fermion/fermionic_bath_intro/">Introduction</a></li><li><a class="tocitem" href="../bath_fermion/Fermion_Lorentz/">Lorentz Spectral Density</a></li></ul></li><li><a class="tocitem" href="../ADOs/">Auxiliary Density Operators</a></li><li><input class="collapse-toggle" id="menuitem-2-5" type="checkbox"/><label class="tocitem" for="menuitem-2-5"><span class="docs-label">HEOMLS Matrices</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../heom_matrix/HEOMLS_intro/">Introduction</a></li><li><a class="tocitem" href="../heom_matrix/schrodinger_eq/">HEOMLS for Schrödinger Equation</a></li><li><a class="tocitem" href="../heom_matrix/M_Boson/">HEOMLS for Bosonic Bath</a></li><li><a class="tocitem" href="../heom_matrix/M_Fermion/">HEOMLS for Fermionic Bath</a></li><li><a class="tocitem" href="../heom_matrix/M_Boson_Fermion/">HEOMLS for Bosonic and Fermionic Bath</a></li><li><a class="tocitem" href="../heom_matrix/master_eq/">HEOMLS for Master Equation</a></li></ul></li><li><a class="tocitem" href="../Parity/">Parity Support</a></li><li><a class="tocitem" href="../hierarchy_dictionary/">Hierarchy Dictionary</a></li><li><a class="tocitem" href="../time_evolution/">Time Evolution</a></li><li><a class="tocitem" href="../stationary_state/">Stationary State</a></li><li class="is-active"><a class="tocitem" href>Spectrum</a><ul class="internal"><li><a class="tocitem" href="#Introduction"><span>Introduction</span></a></li><li><a class="tocitem" href="#Common-and-optional-parameters"><span>Common and optional parameters</span></a></li><li><a class="tocitem" href="#doc-PS"><span>Power Spectrum</span></a></li><li><a class="tocitem" href="#doc-DOS"><span>Density of States</span></a></li></ul></li><li><a class="tocitem" href="../examples/">Examples</a></li><li><input class="collapse-toggle" id="menuitem-2-12" type="checkbox"/><label class="tocitem" for="menuitem-2-12"><span class="docs-label">Solvers Lists</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../ODE_solvers/">DifferentialEquations solvers</a></li><li><a class="tocitem" href="../LS_solvers/">LinearSolve solvers</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-2-13" type="checkbox"/><label class="tocitem" for="menuitem-2-13"><span class="docs-label">Extensions</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../extensions/CUDA/">CUDA.jl</a></li></ul></li></ul></li><li><a class="tocitem" href="../libraryAPI/">Library API</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Manual</a></li><li class="is-active"><a href>Spectrum</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Spectrum</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/qutip/HierarchicalEOM.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/qutip/HierarchicalEOM.jl/blob/main/docs/src/spectrum.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="doc-Spectrum"><a class="docs-heading-anchor" href="#doc-Spectrum">Spectrum</a><a id="doc-Spectrum-1"></a><a class="docs-heading-anchor-permalink" href="#doc-Spectrum" title="Permalink"></a></h1><h2 id="Introduction"><a class="docs-heading-anchor" href="#Introduction">Introduction</a><a id="Introduction-1"></a><a class="docs-heading-anchor-permalink" href="#Introduction" title="Permalink"></a></h2><p>We briefly summarize how to numerically compute the spectrum associated with the system degree of freedom. <a href="https://link.aps.org/doi/10.1103/PhysRevLett.109.266403">Phys. Rev. Lett. 109, 266403 (2012)</a> showed that the spectrum can be evaluated either in time or frequency domain.</p><p><code>HierarchicalEOM.jl</code> provides the following listed functions which performs the calculation of spectrum in frequency domain.</p><ul><li><a href="#doc-PS">Power Spectrum</a></li><li><a href="#doc-DOS">Density of States</a></li></ul><p><code>HierarchicalEOM.jl</code> wraps some of the functions in <a href="http://linearsolve.sciml.ai/stable/">LinearSolve.jl</a>, which is a very rich numerical library for solving the linear problems and provides many solvers. It offers quite a few options for the user to tailor the solver to their specific needs. The default solver (and its corresponding settings) are chosen to suit commonly encountered problems and should work fine for most of the cases. If you require more specialized methods, such as the choice of algorithm, please refer to <a href="../LS_solvers/#LS-solvers">LinearSolve solvers</a> and also the documentation of <a href="http://linearsolve.sciml.ai/stable/">LinearSolve.jl</a>.</p><div class="admonition is-compat"><header class="admonition-header">Extension for CUDA.jl</header><div class="admonition-body"><p><code>HierarchicalEOM.jl</code> provides an extension to support GPU (<a href="https://github.com/JuliaGPU/CUDA.jl"><code>CUDA.jl</code></a>) acceleration for solving the spectrum, but this feature requires <code>Julia 1.9+</code> and <code>HierarchicalEOM 1.1+</code>. See <a href="../extensions/CUDA/#doc-ext-CUDA">here</a> for more details.</p></div></div><p>The output of the above listed functions will always be in the type of <code>Vector{Float64}</code>, which contains the list of the spectrum values corresponding to the given <code>ωlist</code>.</p><h2 id="Common-and-optional-parameters"><a class="docs-heading-anchor" href="#Common-and-optional-parameters">Common and optional parameters</a><a id="Common-and-optional-parameters-1"></a><a class="docs-heading-anchor-permalink" href="#Common-and-optional-parameters" title="Permalink"></a></h2><p>Furthermore, there are two common optional parameters for all the functions provided below:</p><ul><li><code>verbose::Bool</code> : To display verbose output and progress bar during the process or not. Defaults to <code>true</code>.</li><li><code>filename::String</code> : If filename was specified, the value of spectrum for each ω will be saved into the file &quot;filename.txt&quot; during the solving process.</li></ul><p>If the filename is specified, the function will automatically save (update) the value (together with a comma behind it) to a new line in the file (with &quot;.txt&quot; behind the filename) once it obtains the solution of each specified <span>$\omega$</span>. For example, if you specify <code>filename=&quot;test&quot;</code> and <code>ωlist=0:1:5</code>, you will obtain a file <code>test.txt</code> where each line in this file (as shown below) is the result of spectrum corresponding to the given <code>ωlist</code>:</p><pre><code class="nohighlight hljs"># (the content inside test.txt) #
0.4242990296334028,
0.28617768129333854,
0.21332961856387556,
0.1751179183484055,
0.15739257286986685,
0.1518018484057393,
</code></pre><p>For your convenience, we add those commas (&quot;,&quot;) in the end of each line for the users to easily do &quot;copy-and-paste&quot; and load these results back into julia&#39;s kernel (construct a vector of the given results) again, namely</p><pre><code class="language-julia hljs">results = [
0.4242990296334028,
0.28617768129333854,
0.21332961856387556,
0.1751179183484055,
0.15739257286986685,
0.1518018484057393
]</code></pre><h2 id="doc-PS"><a class="docs-heading-anchor" href="#doc-PS">Power Spectrum</a><a id="doc-PS-1"></a><a class="docs-heading-anchor-permalink" href="#doc-PS" title="Permalink"></a></h2><p>Start from the power spectrum in the time-domain. We write the system two-time correlation function in terms of the propagator <span>$\hat{\mathcal{G}}(t)=\exp(\hat{\mathcal{M}} t)$</span> for <span>$t&gt;0$</span>. The power spectrum <span>$\pi S(\omega)$</span> can be obtained as</p><p class="math-container">\[\begin{aligned}
\pi S(\omega) 
&amp;= \textrm{Re}\left\{\int_0^\infty dt \langle P(t)Q(0)\rangle e^{-i\omega t}\right\}\\
&amp;= \textrm{Re}\left\{\int_0^\infty dt \langle P e^{\hat{\mathcal{M}} t}Q\rangle e^{-i\omega t}\right\}\\
&amp;= -\textrm{Re}\left\{\langle P (\hat{\mathcal{M}} -i\omega)^{-1} Q\rangle\right\}\\
&amp;= -\textrm{Re}\left\{\textrm{Tr}\left[ P (\hat{\mathcal{M}} -i\omega)^{-1} Q\rho^{(m,n,+)}_{\textbf{j} \vert \textbf{q}}\right]\right\},
\end{aligned}\]</p><p>where a half-Fourier transform has been introduced in the third line. We note that only the reduced density operator (<span>$m=n=0$</span>) is considered when taking the final trace operation.</p><p>This function solves the linear problem <span>$\textbf{A x}=\textbf{b}$</span> at a fixed frequency <span>$\omega$</span> where </p><ul><li><span>$\textbf{A}=\hat{\mathcal{M}}-i\omega$</span></li><li><span>$\textbf{b}=Q\rho^{(m,n,+)}_{\textbf{j} \vert \textbf{q}}$</span> </li></ul><p>using the package <a href="http://linearsolve.sciml.ai/stable/">LinearSolve.jl</a>.</p><p>Finally, one can obtain the value of the power spectrum for specific <span>$\omega$</span>, namely</p><p class="math-container">\[\pi S(\omega) = -\textrm{Re}\left\{\textrm{Tr}\left[ P \textbf{x}\right]\right\}.\]</p><div class="admonition is-info"><header class="admonition-header">Odd-Parity for Power Spectrum</header><div class="admonition-body"><p>When <span>$Q$</span> is an operator acting on fermionic systems and has <code>ODD</code>-parity, the HEOMLS matrix <span>$\hat{\mathcal{M}}$</span> is acting on the <code>ODD</code>-parity space because <span>$\textbf{b}=Q\rho^{(m,n,+)}_{\textbf{j} \vert \textbf{q}}$</span>. Therefore, remember to construct <span>$\hat{\mathcal{M}}$</span> with <code>ODD</code> <a href="../Parity/#doc-Parity">parity</a> in this kind of cases.</p></div></div><p>See also the docstring <a href="../libraryAPI/#HierarchicalEOM.PowerSpectrum"><code>PowerSpectrum</code></a>.</p><pre><code class="language-julia hljs">M::AbstractHEOMLSMatrix

# the input state can be in either type (but usually ADOs):
ρ::QuantumObject # the reduced density operator
ρ::ADOs # the ADOs solved from &quot;evolution&quot; or &quot;steadystate&quot;

P::QuantumObject 
Q::QuantumObject

# the spectrum value for the specific frequency ω which need to be solved
ωlist = 0:0.5:2 # [0.0, 0.5, 1.0, 1.5, 2.0]

πSω = spectrum(M, ρ,    Q, ωlist) # P will automatically be considered as &quot;the adjoint of Q operator&quot;
πSω = spectrum(M, ρ, P, Q, ωlist) # user specify both P and Q operator</code></pre><h2 id="doc-DOS"><a class="docs-heading-anchor" href="#doc-DOS">Density of States</a><a id="doc-DOS-1"></a><a class="docs-heading-anchor-permalink" href="#doc-DOS" title="Permalink"></a></h2><p>Start from the density of states for fermionic systems in the time-domain. We write the system two-time correlation function in terms of the propagator <span>$\hat{\mathcal{G}}(t)=\exp(\hat{\mathcal{M}} t)$</span> for <span>$t&gt;0$</span>. The density of states <span>$\pi A(\omega)$</span> can be obtained as</p><p class="math-container">\[\begin{aligned}
\pi A(\omega) 
&amp;= \textrm{Re}\left\{\int_0^\infty dt \langle d(t)d^\dagger(0)\rangle e^{i\omega t}\right\} + \textrm{Re}\left\{\int_0^\infty dt \langle d^\dagger(t)d(0)\rangle e^{-i\omega t}\right\}\\
&amp;= \textrm{Re}\left\{\int_0^\infty dt \langle d e^{\hat{\mathcal{M}} t}d^\dagger\rangle e^{i\omega t}\right\}+\textrm{Re}\left\{\int_0^\infty dt \langle d^\dagger e^{\hat{\mathcal{M}} t}d\rangle e^{-i\omega t}\right\}\\
&amp;= -\textrm{Re}\left\{\langle d (\hat{\mathcal{M}} +i\omega)^{-1} d^\dagger\rangle + \langle d^\dagger (\hat{\mathcal{M}} -i\omega)^{-1} d\rangle\right\}\\
&amp;= -\textrm{Re}\left\{\textrm{Tr}\left[ d (\hat{\mathcal{M}} +i\omega)^{-1} d^\dagger\rho^{(m,n,+)}_{\textbf{j} \vert \textbf{q}}\right] + \textrm{Tr}\left[ d^\dagger (\hat{\mathcal{M}} -i\omega)^{-1} d\rho^{(m,n,+)}_{\textbf{j} \vert \textbf{q}}\right]\right\},
\end{aligned}\]</p><p>where a half-Fourier transform has been introduced in the third line. We note that only the reduced density operator (<span>$m=n=0$</span>) is considered when taking the final trace operation.</p><p>This functionsolves two linear problems <span>$\textbf{A}_+ \textbf{x}_+=\textbf{b}_+$</span> and <span>$\textbf{A}_- \textbf{x}_-=\textbf{b}_-$</span> at a fixed frequency <span>$\omega$</span> where </p><ul><li><span>$\textbf{A}_+=\hat{\mathcal{M}}+i\omega$</span></li><li><span>$\textbf{b}_+=d^\dagger\rho^{(m,n,+)}_{\textbf{j} \vert \textbf{q}}$</span> </li><li><span>$\textbf{A}_-=\hat{\mathcal{M}}-i\omega$</span></li><li><span>$\textbf{b}_-=d\rho^{(m,n,+)}_{\textbf{j} \vert \textbf{q}}$</span> </li></ul><p>using the package <a href="http://linearsolve.sciml.ai/stable/">LinearSolve.jl</a>.</p><p>Finally, one can obtain the density of states for specific <span>$\omega$</span>, namely</p><p class="math-container">\[\pi A(\omega) = -\textrm{Re}\left\{\textrm{Tr}\left[ d \textbf{x}_+\right]+\textrm{Tr}\left[ d^\dagger \textbf{x}_-\right]\right\}.\]</p><div class="admonition is-info"><header class="admonition-header">Odd-Parity for Density of States</header><div class="admonition-body"><p>As shown above, the HEOMLS matrix <span>$\hat{\mathcal{M}}$</span> acts on the <code>ODD</code>-parity space, compatibly with the parity of both the operators <span>$\textbf{b}_-=d\rho^{(m,n,+)}_{\textbf{j} \vert \textbf{q}}$</span> and <span>$\textbf{b}_+=d^\dagger\rho^{(m,n,+)}_{\textbf{j} \vert \textbf{q}}$</span>. Therefore, remember to construct <span>$\hat{\mathcal{M}}$</span> with <code>ODD</code> <a href="../Parity/#doc-Parity">parity</a> for solving spectrum of fermionic systems.</p></div></div><p>See also the docstring <a href="../libraryAPI/#HierarchicalEOM.DensityOfStates"><code>DensityOfStates</code></a>.</p><pre><code class="language-julia hljs">Hs::QuantumObject  # system Hamiltonian
bath::FermionBath  # fermionic bath object
tier::Int          # fermionic truncation level 

# create HEOMLS matrix in both :even and ODD parity
M_even = M_Fermion(Hs, tier, bath) 
M_odd  = M_Fermion(Hs, tier, bath, ODD) 

# the input state can be in either type of density operator matrix or ADOs (but usually ADOs):
ados = steadystate(M_even)

# the (usually annihilation) operator &quot;d&quot; as shown above
d::QuantumObject 

# the spectrum value for the specific frequency ω which need to be solved
ω_list = 0:0.5:2 # [0.0, 0.5, 1.0, 1.5, 2.0]

πAω = DensityOfStates(M_odd, ados, d, ω_list)</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../stationary_state/">« Stationary State</a><a class="docs-footer-nextpage" href="../examples/">Examples »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.8.1 on <span class="colophon-date" title="Monday 24 February 2025 18:18">Monday 24 February 2025</span>. Using Julia version 1.11.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
