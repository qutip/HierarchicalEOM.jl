<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Time Evolution · Documentation | HierarchicalEOM.jl</title><meta name="title" content="Time Evolution · Documentation | HierarchicalEOM.jl"/><meta property="og:title" content="Time Evolution · Documentation | HierarchicalEOM.jl"/><meta property="twitter:title" content="Time Evolution · Documentation | HierarchicalEOM.jl"/><meta name="description" content="Documentation for Documentation | HierarchicalEOM.jl."/><meta property="og:description" content="Documentation for Documentation | HierarchicalEOM.jl."/><meta property="twitter:description" content="Documentation for Documentation | HierarchicalEOM.jl."/><meta property="og:url" content="https://qutip.github.io/HierarchicalEOM.jl/time_evolution/"/><meta property="twitter:url" content="https://qutip.github.io/HierarchicalEOM.jl/time_evolution/"/><link rel="canonical" href="https://qutip.github.io/HierarchicalEOM.jl/time_evolution/"/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img class="docs-light-only" src="../assets/logo.png" alt="Documentation | HierarchicalEOM.jl logo"/><img class="docs-dark-only" src="../assets/logo-dark.png" alt="Documentation | HierarchicalEOM.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">Documentation | HierarchicalEOM.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><span class="tocitem">Home</span><ul><li><a class="tocitem" href="../">Introduction</a></li><li><a class="tocitem" href="../install/">Installation</a></li><li><a class="tocitem" href="../quick_start/">Quick Start</a></li><li><a class="tocitem" href="../cite/">Cite HierarchicalEOM.jl</a></li></ul></li><li><span class="tocitem">Manual</span><ul><li><input class="collapse-toggle" id="menuitem-2-1" type="checkbox"/><label class="tocitem" for="menuitem-2-1"><span class="docs-label">Bosonic Bath</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../bath_boson/bosonic_bath_intro/">Introduction</a></li><li><a class="tocitem" href="../bath_boson/Boson_Drude_Lorentz/">Drude-Lorentz Spectral Density</a></li><li><a class="tocitem" href="../bath_boson/Boson_Underdamped/">Underdamped Spectral Density</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-2-2" type="checkbox"/><label class="tocitem" for="menuitem-2-2"><span class="docs-label">Bosonic Bath (RWA)</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../bath_boson_RWA/bosonic_bath_RWA_intro/">Introduction</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-2-3" type="checkbox"/><label class="tocitem" for="menuitem-2-3"><span class="docs-label">Fermionic Bath</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../bath_fermion/fermionic_bath_intro/">Introduction</a></li><li><a class="tocitem" href="../bath_fermion/Fermion_Lorentz/">Lorentz Spectral Density</a></li></ul></li><li><a class="tocitem" href="../ADOs/">Auxiliary Density Operators</a></li><li><input class="collapse-toggle" id="menuitem-2-5" type="checkbox"/><label class="tocitem" for="menuitem-2-5"><span class="docs-label">HEOMLS Matrices</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../heom_matrix/HEOMLS_intro/">Introduction</a></li><li><a class="tocitem" href="../heom_matrix/schrodinger_eq/">HEOMLS for Schrödinger Equation</a></li><li><a class="tocitem" href="../heom_matrix/M_Boson/">HEOMLS for Bosonic Bath</a></li><li><a class="tocitem" href="../heom_matrix/M_Fermion/">HEOMLS for Fermionic Bath</a></li><li><a class="tocitem" href="../heom_matrix/M_Boson_Fermion/">HEOMLS for Bosonic and Fermionic Bath</a></li><li><a class="tocitem" href="../heom_matrix/master_eq/">HEOMLS for Master Equation</a></li></ul></li><li><a class="tocitem" href="../Parity/">Parity Support</a></li><li><a class="tocitem" href="../hierarchy_dictionary/">Hierarchy Dictionary</a></li><li class="is-active"><a class="tocitem" href>Time Evolution</a><ul class="internal"><li><a class="tocitem" href="#Introduction"><span>Introduction</span></a></li><li><a class="tocitem" href="#Common-and-optional-parameters"><span>Common and optional parameters</span></a></li><li><a class="tocitem" href="#Ordinary-Differential-Equation-(ODE)-Method"><span>Ordinary Differential Equation (ODE) Method</span></a></li><li><a class="tocitem" href="#Time-Dependent-Problems"><span>Time Dependent Problems</span></a></li><li><a class="tocitem" href="#Propagator-Method"><span>Propagator Method</span></a></li></ul></li><li><a class="tocitem" href="../stationary_state/">Stationary State</a></li><li><a class="tocitem" href="../spectrum/">Spectrum</a></li><li><a class="tocitem" href="../examples/">Examples</a></li><li><input class="collapse-toggle" id="menuitem-2-12" type="checkbox"/><label class="tocitem" for="menuitem-2-12"><span class="docs-label">Solvers Lists</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../ODE_solvers/">DifferentialEquations solvers</a></li><li><a class="tocitem" href="../LS_solvers/">LinearSolve solvers</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-2-13" type="checkbox"/><label class="tocitem" for="menuitem-2-13"><span class="docs-label">Extensions</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../extensions/CUDA/">CUDA.jl</a></li></ul></li></ul></li><li><a class="tocitem" href="../libraryAPI/">Library API</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Manual</a></li><li class="is-active"><a href>Time Evolution</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Time Evolution</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/qutip/HierarchicalEOM.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/qutip/HierarchicalEOM.jl/blob/main/docs/src/time_evolution.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="doc-Time-Evolution"><a class="docs-heading-anchor" href="#doc-Time-Evolution">Time Evolution</a><a id="doc-Time-Evolution-1"></a><a class="docs-heading-anchor-permalink" href="#doc-Time-Evolution" title="Permalink"></a></h1><h2 id="Introduction"><a class="docs-heading-anchor" href="#Introduction">Introduction</a><a id="Introduction-1"></a><a class="docs-heading-anchor-permalink" href="#Introduction" title="Permalink"></a></h2><p><code>HierarchicalEOM.jl</code> implements various methods and solvers to simulate the open quantum system dynamics.  The <a href="../heom_matrix/HEOMLS_intro/#doc-HEOMLS-Matrix">HEOM Liouvillian superoperator (HEOMLS) matrix</a> <span>$\hat{\mathcal{M}}$</span> characterizes the dynamics of the reduce state and in the full extended space of all <a href="../ADOs/#doc-ADOs">auxiliary density operators (ADOs)</a> <span>$\rho^{(m,n,p)}_{\textbf{j} \vert \textbf{q}}(t)$</span>, namely</p><p class="math-container">\[\begin{equation}
\partial_{t}\rho^{(m,n,p)}_{\textbf{j} \vert \textbf{q}}(t)=\hat{\mathcal{M}}\rho^{(m,n,p)}_{\textbf{j} \vert \textbf{q}}(t)
\end{equation}\]</p><h3 id="HEOMsolve-and-TimeEvolutionHEOMSol"><a class="docs-heading-anchor" href="#HEOMsolve-and-TimeEvolutionHEOMSol"><code>HEOMsolve</code> and <code>TimeEvolutionHEOMSol</code></a><a id="HEOMsolve-and-TimeEvolutionHEOMSol-1"></a><a class="docs-heading-anchor-permalink" href="#HEOMsolve-and-TimeEvolutionHEOMSol" title="Permalink"></a></h3><p>To solve the dynamics of the reduced state and also all the <a href="../ADOs/#doc-ADOs">ADOs</a>, you only need to call <a href="../libraryAPI/#HierarchicalEOM.HEOMsolve"><code>HEOMsolve</code></a>. Different methods (see the contents below) are implemented with different input parameters of the function which makes it easy to switch between different methods. The output of the function <a href="../libraryAPI/#HierarchicalEOM.HEOMsolve"><code>HEOMsolve</code></a> for each methods will always be in the type <a href="../libraryAPI/#HierarchicalEOM.TimeEvolutionHEOMSol"><code>TimeEvolutionHEOMSol</code></a>, which contains the results (including <a href="../libraryAPI/#HierarchicalEOM.ADOs"><code>ADOs</code></a> and expectation values at each time point) and some information from the solver. One can obtain the value of each fields in <a href="../libraryAPI/#HierarchicalEOM.TimeEvolutionHEOMSol"><code>TimeEvolutionHEOMSol</code></a> as follows:</p><pre><code class="language-julia hljs">sol::TimeEvolutionHEOMSol

sol.Btier   # the tier (cutoff level) for bosonic hierarchy
sol.Ftier   # the tier (cutoff level) for fermionic hierarchy
sol.times   # The time list of the evolution.
sol.ados    # The list of result ADOs at each time point.
sol.expect  # The expectation values corresponding to each time point in `times`.
sol.retcode # The return code from the solver.
sol.alg     # The algorithm which is used during the solving process.
sol.abstol  # The absolute tolerance which is used during the solving process.
sol.reltol  # The relative tolerance which is used during the solving process.</code></pre><h3 id="Expectation-Values"><a class="docs-heading-anchor" href="#Expectation-Values">Expectation Values</a><a id="Expectation-Values-1"></a><a class="docs-heading-anchor-permalink" href="#Expectation-Values" title="Permalink"></a></h3><p>Given an observable <span>$A$</span> and the <a href="../ADOs/#doc-ADOs"><code>ADOs</code></a> <span>$\rho^{(m,n,p)}_{\textbf{j} \vert \textbf{q}}(t)$</span>, one can calculate the expectation value by</p><p class="math-container">\[\langle A(t) \rangle = \textrm{Tr}\left[A \rho^{(0,0,p)}_{ \vert }(t)\right],\]</p><p>where, <span>$m=n=0$</span> represents the reduced density operator, see <a href="../ADOs/#doc-ADOs"><code>ADOs</code></a> for more details.</p><p>One can directly calculate the expectation value by specifying the keyword argument <code>e_ops</code> (a list of observables), and the expectation values corresponding to each time point and observables will be stored in <a href="../libraryAPI/#HierarchicalEOM.TimeEvolutionHEOMSol"><code>TimeEvolutionHEOMSol</code></a>:</p><pre><code class="language-julia hljs">A1::QuantumObject # observable 1
A2::QuantumObject # observable 2
sol = HEOMsolve(...; e_ops = [A1, A2], ...) # the input parameters depend on the different methods you choose.
sol.expect[1,:] # the expectation values of observable 1 (`A1`) corresponding to each time point in `sol.times`
sol.expect[2,:] # the expectation values of observable 2 (`A2`) corresponding to each time point in `sol.times`</code></pre><p>An alternative way for calculating the expectation values is to use the function <a href="../libraryAPI/#QuantumToolbox.expect"><code>QuantumToolbox.expect</code></a> together with the list of <a href="../libraryAPI/#HierarchicalEOM.ADOs"><code>ADOs</code></a> stored in <a href="../libraryAPI/#HierarchicalEOM.TimeEvolutionHEOMSol"><code>TimeEvolutionHEOMSol</code></a>:</p><pre><code class="language-julia hljs">A::QuantumObject # observable
sol = HEOMsolve(...) # the input parameters depend on the different methods you choose.
ados_list = sol.ados

Elist = expect(A, ados_list)</code></pre><p>Here, <code>Elist</code> contains the expectation values corresponding to the <code>ados_list</code> (i.e., the reduced density operator in each time step).</p><h2 id="Common-and-optional-parameters"><a class="docs-heading-anchor" href="#Common-and-optional-parameters">Common and optional parameters</a><a id="Common-and-optional-parameters-1"></a><a class="docs-heading-anchor-permalink" href="#Common-and-optional-parameters" title="Permalink"></a></h2><p>There are three common optional parameters for all the methods provided below:</p><ul><li><code>e_ops::Union{Nothing,AbstractVector}</code>: List of operators for which to calculate expectation values.</li><li><code>verbose::Bool</code> : To display verbose output and progress bar during the process or not. Defaults to <code>true</code>.</li><li><code>filename::String</code> : If filename was specified, the ADOs at each time point will be saved into the JLD2 file after the solving process. Default to Empty <code>String</code>: <code>&quot;&quot;</code>.</li></ul><p>If the <code>filename</code> is specified, the function will automatically save the <a href="../libraryAPI/#HierarchicalEOM.ADOs"><code>ADOs</code></a> to the file (with <code>.jld2</code> behind the <code>filename</code>) once the solving process is finished. The saving method is based on the package <a href="https://juliaio.github.io/JLD2.jl/stable/"><code>JLD2.jl</code></a>, which saves and loads <code>Julia</code> data structures in a format comprising a subset of HDF5.</p><pre><code class="language-julia hljs">tlist = 0:0.5:5
ados_list = HEOMsolve(..., tlist, ...; filename=&quot;test&quot;, ...)</code></pre><p>The solution of the <a href="../libraryAPI/#HierarchicalEOM.ADOs"><code>ADOs</code></a> for each time step in <code>tlist</code> is saved in the file named <code>test.jld2</code> with a key: <code>&quot;ados&quot;</code>.</p><p>To retrieve the solution the list of <a href="../libraryAPI/#HierarchicalEOM.ADOs"><code>ADOs</code></a> from a previously saved file <code>&quot;text.jld2&quot;</code>, just read the file with the methods provided by <a href="https://juliaio.github.io/JLD2.jl/stable/"><code>JLD2.jl</code></a> and specify the key: <code>&quot;ados&quot;</code>, namely</p><pre><code class="language-julia hljs">using HierarchicalEOM, JLD2 # remember to import these before retrieving the solution

filename = &quot;test.jld2&quot;
jldopen(filename, &quot;r&quot;) do file
    ados_list = file[&quot;ados&quot;]
end</code></pre><h2 id="Ordinary-Differential-Equation-(ODE)-Method"><a class="docs-heading-anchor" href="#Ordinary-Differential-Equation-(ODE)-Method">Ordinary Differential Equation (ODE) Method</a><a id="Ordinary-Differential-Equation-(ODE)-Method-1"></a><a class="docs-heading-anchor-permalink" href="#Ordinary-Differential-Equation-(ODE)-Method" title="Permalink"></a></h2><p>The first method is implemented by solving the ordinary differential equation (ODE). <code>HierarchicalEOM.jl</code> wraps some of the functions in <a href="https://diffeq.sciml.ai/stable/"><code>DifferentialEquations.jl</code></a>, which is a very rich numerical library for solving the differential equations and provides many ODE solvers. It offers quite a few options for the user to tailor the solver to their specific needs. The default solver (and its corresponding settings) are chosen to suit commonly encountered problems and should work fine for most of the cases. If you require more specialized methods, such as the choice of algorithm, please refer to <a href="../ODE_solvers/#ODE-solvers">DifferentialEquations solvers</a> and also the documentation of <a href="https://diffeq.sciml.ai/stable/"><code>DifferentialEquations.jl</code></a>.</p><div class="admonition is-compat" id="Extension-for-CUDA.jl-1d3dde2d5a785ca0"><header class="admonition-header">Extension for CUDA.jl<a class="admonition-anchor" href="#Extension-for-CUDA.jl-1d3dde2d5a785ca0" title="Permalink"></a></header><div class="admonition-body"><p><code>HierarchicalEOM.jl</code> provides an extension to support GPU (<a href="https://github.com/JuliaGPU/CUDA.jl"><code>CUDA.jl</code></a>) acceleration for <a href="../libraryAPI/#HierarchicalEOM.HEOMsolve"><code>HEOMsolve</code></a> (only for ODE method). See <a href="../extensions/CUDA/#doc-ext-CUDA">here</a> for more details.</p></div></div><p>See the docstring of this method:  </p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="HierarchicalEOM.HEOMsolve-Union{Tuple{T_state}, Tuple{AbstractHEOMLSMatrix, T_state, AbstractVector}} where T_state&lt;:Union{ADOs, QuantumObject}" href="#HierarchicalEOM.HEOMsolve-Union{Tuple{T_state}, Tuple{AbstractHEOMLSMatrix, T_state, AbstractVector}} where T_state&lt;:Union{ADOs, QuantumObject}"><code>HierarchicalEOM.HEOMsolve</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">HEOMsolve(M, ρ0, tlist; e_ops, solver, H_t, params, verbose, filename, inplace, SOLVEROptions...)
heomsolve(M, ρ0, tlist; e_ops, solver, H_t, params, verbose, filename, inplace, SOLVEROptions...)</code></pre><p>Solve the time evolution for auxiliary density operators based on ordinary differential equations.</p><p><strong>Parameters</strong></p><ul><li><code>M::AbstractHEOMLSMatrix</code> : the matrix given from HEOM model</li><li><code>ρ0::Union{QuantumObject,ADOs}</code> : system initial state (density matrix) or initial auxiliary density operators (<code>ADOs</code>)</li><li><code>tlist::AbstractVector</code> : Denote the specific time points to save the solution at, during the solving process.</li><li><code>e_ops::Union{Nothing,AbstractVector}</code>: List of operators for which to calculate expectation values.</li><li><code>solver::OrdinaryDiffEqAlgorithm</code> : solver in package <code>DifferentialEquations.jl</code>. Default to <code>DP5()</code>.</li><li><code>H_t::Union{Nothing,QuantumObjectEvolution}</code>: The time-dependent system Hamiltonian or Liouvillian. Default to <code>nothing</code>.</li><li><code>params</code>: Parameters to pass to the solver. This argument is usually expressed as a <code>NamedTuple</code> or <code>AbstractVector</code> of parameters. For more advanced usage, any custom struct can be used.</li><li><code>verbose::Bool</code> : To display verbose output and progress bar during the process or not. Defaults to <code>true</code>.</li><li><code>filename::String</code> : If filename was specified, the ADOs at each time point will be saved into the JLD2 file &quot;filename.jld2&quot; after the solving process.</li><li><code>inplace::Bool</code>: Whether to use the inplace version of the ODEProblem. Defaults to <code>true</code>.</li><li><code>SOLVEROptions</code> : extra options for solver</li></ul><p><strong>Notes</strong></p><ul><li>The <a href="../libraryAPI/#HierarchicalEOM.ADOs"><code>ADOs</code></a> will be saved depend on the keyword argument <code>saveat</code> in <code>kwargs</code>.</li><li>If <code>e_ops</code> is specified, the default value of <code>saveat=[tlist[end]]</code> (only save the final <code>ADOs</code>), otherwise, <code>saveat=tlist</code> (saving the <code>ADOs</code> corresponding to <code>tlist</code>). You can also specify <code>e_ops</code> and <code>saveat</code> separately.</li><li>The default tolerances in <code>kwargs</code> are given as <code>reltol=1e-6</code> and <code>abstol=1e-8</code>.</li><li>For more details about <code>solver</code> please refer to <a href="https://docs.sciml.ai/DiffEqDocs/stable/solvers/ode_solve/"><code>DifferentialEquations.jl</code> (ODE Solvers)</a></li><li>For more details about <code>SOLVEROptions</code> please refer to <a href="https://docs.sciml.ai/DiffEqDocs/stable/basics/common_solver_opts/"><code>DifferentialEquations.jl</code> (Keyword Arguments)</a></li></ul><p><strong>Returns</strong></p><ul><li>sol::TimeEvolutionHEOMSol : The solution of the hierarchical EOM. See also <a href="../libraryAPI/#HierarchicalEOM.TimeEvolutionHEOMSol"><code>TimeEvolutionHEOMSol</code></a></li></ul><div class="admonition is-info" id="Note-c189ccb38fc54242"><header class="admonition-header">Note<a class="admonition-anchor" href="#Note-c189ccb38fc54242" title="Permalink"></a></header><div class="admonition-body"><p><code>heomsolve</code> is a synonym of <code>HEOMsolve</code>.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/qutip/HierarchicalEOM.jl/blob/9f85e7b0380766d2ce185ae8331bdbd047c1f787/src/evolution.jl#L165-L196">source</a></section></article><pre><code class="language-julia hljs"># the time-independent HEOMLS matrix
M::AbstractHEOMLSMatrix  

# the initial state can be either the system density operator or ADOs
ρ0::QuantumObject
ρ0::ADOs

# specific time points to save the solution during the solving process.  
tlist = 0:0.5:2 # [0.0, 0.5, 1.0, 1.5, 2.0]

sol = HEOMsolve(M, ρ0, tlist)</code></pre><h2 id="Time-Dependent-Problems"><a class="docs-heading-anchor" href="#Time-Dependent-Problems">Time Dependent Problems</a><a id="Time-Dependent-Problems-1"></a><a class="docs-heading-anchor-permalink" href="#Time-Dependent-Problems" title="Permalink"></a></h2><p>In general, the time-dependent system Hamiltonian can be separated into the time-independent and time-dependent parts, namely</p><p class="math-container">\[H_s (t) = H_0 + H_1(t).\]</p><p>We again wrap some of the functions in <a href="https://diffeq.sciml.ai/stable/"><code>DifferentialEquations.jl</code></a> to solve the time-dependent problems here.</p><p>To deal with the time-dependent system Hamiltonian problem in <code>HierarchicalEOM.jl</code>, we first construct the <a href="../heom_matrix/HEOMLS_intro/#doc-HEOMLS-Matrix">HEOMLS matrices</a> <span>$\hat{\mathcal{M}}$</span> with <strong>time-independent</strong> Hamiltonian <span>$H_0$</span>:</p><pre><code class="language-julia hljs">M = M_S(H0, ...)
M = M_Boson(H0, ...)
M = M_Fermion(H0, ...)
M = M_BosonFermion(H0, ...)</code></pre><p>To solve the dynamics characterized by <span>$\hat{\mathcal{M}}$</span> together with the time-dependent part of system Hamiltonian <span>$H_1(t)$</span>, you can specify keyword arguments <code>H_t</code> and <code>params</code> while calling <a href="../libraryAPI/#HierarchicalEOM.HEOMsolve"><code>HEOMsolve</code></a>. Here, <code>H_t</code> must be specified as a <code>QuantumToolbox.QuantumObjectEvolution</code> (or <code>QobjEvo</code>), and <code>params</code> should contain all the extra parameters you need for <code>QobjEvo</code>, for example:</p><pre><code class="language-julia hljs"># in this case, p will be passed in as a NamedTuple: (p0 = p0, p1 = p1, p2 = p2)
coef(p::NamedTuple, t) = sin(p.p0 * t) + sin(p.p1 * t) + sin(p.p2 * t)

σx = sigmax() # Pauli-X matrix
H_1 = QobjEvo(σx, coef)</code></pre><p>The <code>p</code> can be passed to <code>H_1</code> directly from the keyword argument in <a href="../libraryAPI/#HierarchicalEOM.HEOMsolve"><code>HEOMsolve</code></a> called <code>params</code>:</p><pre><code class="language-julia hljs">M::AbstractHEOMLSMatrix
ρ0::QuantumObject
tlist = 0:0.1:10
p = (p0 = 0.1, p1 = 1, p2 = 10)

sol = HEOMsolve(M, ρ0, tlist; H_t = H_1, params = p)</code></pre><h2 id="Propagator-Method"><a class="docs-heading-anchor" href="#Propagator-Method">Propagator Method</a><a id="Propagator-Method-1"></a><a class="docs-heading-anchor-permalink" href="#Propagator-Method" title="Permalink"></a></h2><p>The second method is implemented by directly construct the propagator of a given <a href="../heom_matrix/HEOMLS_intro/#doc-HEOMLS-Matrix">HEOMLS matrix</a> <span>$\hat{\mathcal{M}}$</span>. Because <span>$\hat{\mathcal{M}}$</span> is time-independent, the equation above can be solved analytically as</p><p class="math-container">\[\rho^{(m,n,p)}_{\textbf{j} \vert \textbf{q}}(t)=\hat{\mathcal{G}}(t)\rho^{(m,n,p)}_{\textbf{j} \vert \textbf{q}}(0),\]</p><p>where <span>$\hat{\mathcal{G}}(t)\equiv \exp(\hat{\mathcal{M}}t)$</span> is the propagator for all <a href="../ADOs/#doc-ADOs">ADOs</a> corresponding to <span>$\hat{\mathcal{M}}$</span>.</p><p>To construct the propagator, we wrap the function in the package <a href="https://github.com/fmentink/FastExpm.jl"><code>fastExpm.jl</code></a>, which is optimized for the exponentiation of either large-dense or sparse matrices.</p><p>See the docstring of this method:  </p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="HierarchicalEOM.HEOMsolve-Union{Tuple{T_state}, Tuple{AbstractHEOMLSMatrix, T_state, Real, Int64}} where T_state&lt;:Union{ADOs, QuantumObject}" href="#HierarchicalEOM.HEOMsolve-Union{Tuple{T_state}, Tuple{AbstractHEOMLSMatrix, T_state, Real, Int64}} where T_state&lt;:Union{ADOs, QuantumObject}"><code>HierarchicalEOM.HEOMsolve</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">HEOMsolve(M, ρ0, Δt, steps; e_ops, threshold, nonzero_tol, verbose, filename)
heomsolve(M, ρ0, Δt, steps; e_ops, threshold, nonzero_tol, verbose, filename)</code></pre><p>Solve the time evolution for auxiliary density operators based on propagator (generated by <code>FastExpm.jl</code>).</p><p><strong>Parameters</strong></p><ul><li><code>M::AbstractHEOMLSMatrix</code> : the matrix given from HEOM model</li><li><code>ρ0::Union{QuantumObject,ADOs}</code> : system initial state (density matrix) or initial auxiliary density operators (<code>ADOs</code>)</li><li><code>Δt::Real</code> : A specific time step (time interval).</li><li><code>steps::Int</code> : The number of time steps</li><li><code>e_ops::Union{Nothing,AbstractVector}</code>: List of operators for which to calculate expectation values.</li><li><code>threshold::Real</code> : Determines the threshold for the Taylor series. Defaults to <code>1.0e-6</code>.</li><li><code>nonzero_tol::Real</code> : Strips elements smaller than <code>nonzero_tol</code> at each computation step to preserve sparsity. Defaults to <code>1.0e-14</code>.</li><li><code>verbose::Bool</code> : To display verbose output and progress bar during the process or not. Defaults to <code>true</code>.</li><li><code>filename::String</code> : If filename was specified, the ADOs at each time point will be saved into the JLD2 file &quot;filename.jld2&quot; after the solving process.</li></ul><p><strong>Notes</strong></p><ul><li>The <a href="../libraryAPI/#HierarchicalEOM.ADOs"><code>ADOs</code></a> will be saved depend on the keyword argument <code>e_ops</code>.</li><li>If <code>e_ops</code> is specified, the solution will only save the final <code>ADOs</code>, otherwise, it will save all the <code>ADOs</code> corresponding to <code>tlist = 0:Δt:(Δt * steps)</code>.</li><li>For more details of the propagator, please refer to <a href="https://github.com/fmentink/FastExpm.jl"><code>FastExpm.jl</code></a></li></ul><p><strong>Returns</strong></p><ul><li><code>sol::TimeEvolutionHEOMSol</code> : The solution of the hierarchical EOM. See also <a href="../libraryAPI/#HierarchicalEOM.TimeEvolutionHEOMSol"><code>TimeEvolutionHEOMSol</code></a></li></ul><div class="admonition is-info" id="Note-c189ccb38fc54242"><header class="admonition-header">Note<a class="admonition-anchor" href="#Note-c189ccb38fc54242" title="Permalink"></a></header><div class="admonition-body"><p><code>heomsolve</code> is a synonym of <code>HEOMsolve</code>.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/qutip/HierarchicalEOM.jl/blob/9f85e7b0380766d2ce185ae8331bdbd047c1f787/src/evolution.jl#L49-L76">source</a></section></article><pre><code class="language-julia hljs"># the time-independent HEOMLS matrix
M::AbstractHEOMLSMatrix  

# the initial state can be either the system density operator or ADOs
ρ0::QuantumObject
ρ0::ADOs

# A specific time interval (time step)
Δt = 0.5

# The number of time steps for the propagator to apply
steps = 4

# equivalent to tlist = 0 : Δt : (Δt * steps)
sol = HEOMsolve(M, ρ0, Δt, steps) </code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../hierarchy_dictionary/">« Hierarchy Dictionary</a><a class="docs-footer-nextpage" href="../stationary_state/">Stationary State »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.11.4 on <span class="colophon-date" title="Saturday 17 May 2025 04:21">Saturday 17 May 2025</span>. Using Julia version 1.11.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
